library(devtools)
document()
check()
install()
library(devtools)
check()
document()
check()
install()
library(devtools)
load_all()
load_all()
tidy_data_empty(file.choose(), reverse = TRUE)
df <- xls_read(file.choose())
tidy_data_empty(df, reverse = TRUE)
load_all()
tidy_data_empty(df, reverse = TRUE)
load_all()
df <- xls_read(file.choose())
tidy_data_empty(df, reverse = TRUE)
load_all()
tidy_data_empty(df, reverse = TRUE)
load_all()
tidy_data_empty(df, reverse = TRUE)
ddd <- data.frame(a=1:5, b=2:6)
which(ddd$b>5)
n <- nrow(df)
m <- which(df$A < 0 & df$A < -2)
m <- min(m)
m
m
m <- which(df$A < 0 & df$A > -2)
m <- min(m)
n
m
m <- which(df$A > 0 & df$A < 2)
m
df
view(df)
df <- xls_read(file.choose(), start_row = 17)
view(df)
df <- xls_read(file.choose(), start_row = 19)
m <- which(df$A < 0 & df$A > -3)
m <- min(m)
m
df <- xls_read(file.choose(), start_row = 19)
view(df)
n <- nrow(df)
m <- which(df$A < 0 & df$A > -3)
m <- min(m)
m
m
m <- which(df$A < 0 & df$A > -5)
m
m <- which(df$A < 0 & df$A > -10)
m <- min(m)
df$diffa <- c(0, diff(df$A))
df$diffci <- c(0, diff(df$Ci))
df <- df[m:n, ]
df <-
subset(df, diffa <= abs(delta_max) & A <= 0)
d
load_all()
tidy_data_empty(df, reverse = TRUE)
tidy_data_empty(df, reverse = TRUE)
load_all()
tidy_data_empty(df, reverse = TRUE)
df1 <- tidy_data_empty(df, reverse = TRUE)
check_delta_empty(df1)
check_delta_empty(df)
load_all()
df1\ <- tidy_data_empty(df, reverse = TRUE)
df1 <- tidy_data_empty(df, reverse = TRUE)
tidy_data_empty(df, reverse = TRUE)
df1 <- (df, reverse = TRUE)
df1 <- (df, reverse = TRUE)
df1 <- tidy_data_empty(df, reverse = TRUE)
view(df1)
df$diffa <- c(0, diff(df$A))
df$diffa
df <- xls_read(file.choose(), start_row = 19, delta_max =0.08)
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
view(df1)
load_all()
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
view(df1)
df$diffa <- c(0, diff(df$A))
df$diffa
load_all()
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
view(df1)
view(df1)
df$diffa
df1$diffa
load_all()
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
view(df1)
check_delta_empty(df, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08)
load_all()
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
load_all()
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
load_all()
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
load_all()
df2 <- xls_read(file.choose(), start_row = 19)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.2)
m <- which(df2$A < 0 & df2$A > -10)
m <- min(m)
m
df2$A
df2 <- xls_read(file.choose(), start_row = 19)
view(df2)
df <- xls_read(file.choose())
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
load_all()
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
df2 <- xls_read(file.choose())
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.2)
check_delta_empty(df2, delta_max = 0.08, reverse=TRUE)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.2)
view(df3)
check_delta(df2, delta_max = 0.08, reverse=TRUE)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.2)
view(df3)
df <- xls_read(file.choose())
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
df <- xls_read(file.choose())
load_all()
df <- xls_read(file.choose())
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08, start_row=19)
df <- xls_read(file.choose(), start_row=19)
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
df2 <- xls_read(file.choose())
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.2)
check_delta(df2, delta_max = 0.2, reverse=TRUE)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.1)
check_delta(df2, delta_max = 0.1, reverse=TRUE)
check_delta(df2, delta_max = 0.07, reverse=TRUE)
library(devtools)
load_all()
df <- xls_read(file.choose())
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
load_all()
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.08)
check_delta_empty(df, delta_max = 0.08, reverse=TRUE)
check_delta_empty(df, delta_max = 0.05, reverse=TRUE)
df2 <- xls_read(file.choose())
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.07)
check_delta(df2, delta_max = 0.07, reverse=TRUE)
z <- correct_leaf(df1,df3)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
library(plantecophys)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
fitz$pars
plot(fitz)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.07)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.07)
library(devtools)
load_all()
df <- xls_read(file.choose())
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.05)
df2 <- xls_read(file.choose())
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.07)
library(plantecophys)
z <- correct_leaf(df1,df3)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
fitz$pars
plot(fitz)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.05)
z <- correct_leaf(df1,df3)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
fitz$pars
plot(fitz)
xls_read(file.choose())
ddf <- xls_read(file.choose())
fitddf <- fitaci(ddf,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
fitddf$par
fitz$pars
plot(fitddf)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.2)
z <- correct_leaf(df1,df3)
plot(fitz)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
fitddf <- fitaci(ddf,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
fitz$pars
fitddf$par
view(z)
view(df1)
check_delta_empty(df, delta_max = 0.05, reverse=TRUE)
par()
library(devtools)
load_all()
library(devtools)
load_all()
df <- xls_read(file.choose())
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.05)
view(df1)
check_delta_empty(df, delta_max = 0.05, reverse=TRUE)
df2 <- xls_read(file.choose())
view(df2)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.2)
view(df3)
check_delta(df2, delta_max = 0.05, reverse=TRUE)
library(plantecophys)
z <- correct_leaf(df1,df3)
plot(fitz)
ddf <- xls_read(file.choose())
fitddf <- fitaci(ddf,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
fitz$pars
fitddf$par
view(z)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
plot(fitz)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.05)
z <- correct_leaf(df1,df3)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
plot(fitz)
library(devtools)
load_all()
df <- xls_read(file.choose())
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.3)
check_delta_empty(df, delta_max = 0.05, reverse=TRUE)
df2 <- xls_read(file.choose())
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.3)
library(devtools)
load_all()
df <- xls_read(file.choose())
df1 <- tidy_data_empty(df, reverse = TRUE, delta_max = 0.3)
check_delta_empty(df, delta_max = 0.05, reverse=TRUE)
df2 <- xls_read(file.choose())
check_delta_empty(df, delta_max = 0.3, reverse=TRUE)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.3)
#view(df3)
check_delta(df2, delta_max = 0.3, reverse=TRUE)
#view(df3)
check_delta(df2, delta_max = 0.2, reverse=TRUE)
#view(df3)
check_delta(df2, delta_max = 0.1, reverse=TRUE)
#view(df3)
check_delta(df2, delta_max = 0.08, reverse=TRUE)
df3 <- tidy_data(df2, reverse = TRUE, delta_max = 0.08)
load_all()
#view(df3)
check_delta(df2, delta_max = 0.08, reverse=TRUE)
load_all()
#view(df3)
check_delta(df2, delta_max = 0.08, reverse=TRUE)
#view(df3)
check_delta(df2, delta_max = 0.08, reverse=TRUE)
library(plantecophys)
z <- correct_leaf(df1,df3)
fitz <- fitaci(z,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
plot(fitz)
ddf <- xls_read(file.choose())
fitddf <- fitaci(ddf,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
))
plot(fitddf)
library(devtools)
load_all()
#准备数据 ------------------------------------------------------------------
empty_uc <- xls_read(file.choose())
leaf_uc <- xls_read(file.choose())
# 防止读入空白行
empty_uc <- subset(empty_uc, obs > 0)
leaf_uc <- subset(leaf_uc , obs > 0)
# 观察空叶室未校准数据reference对A的图形
plot(empty_uc$CO2_r, empty_uc$A)
# 选取线性部分用于校准
locator()
empty_ct <- empty_uc[which(empty_uc$CO2_r >
20 & empty_uc$CO2_r < 450.12), ]
plot(empty_ct$CO2_r, empty_ct$A)
# 采用 1~5 次多项式分别拟合
cal1st <- lm(A ~ CO2_r, data = empty_ct)
cal2nd <- lm(A ~ poly(CO2_r, 2), data = empty_ct)
cal3rd <- lm(A ~ poly(CO2_r, 3), data = empty_ct)
cal4th <- lm(A ~ poly(CO2_r, 4), data = empty_ct)
cal5th <- lm(A ~ poly(CO2_r, 5), data = empty_ct)
# 利用 BIC 找出最合理的校准方程
bics <- BIC(cal1st, cal2nd, cal3rd, cal4th, cal5th)
# noquote也就是没引号，成为名字
best <- noquote(rownames(bics)[bics$BIC == min(bics$BIC)])
best
leaf_uc$A <- leaf_uc$A - predict(cal1st, leaf_uc)
leaf_uc$Ci <- ((leaf_uc$gtc - leaf_uc$E / 2) * leaf_uc$CO2_s -
leaf_uc$A) / (leaf_uc$gtc + leaf_uc$E / 2)
# 对校准后的数据进行作图，查看校准效果
plot(leaf_uc$CO2_r,
leaf_uc$A,
pch = 2,
ylim = c(-20, 40))
# 选取带叶片测量的有效数据的范围
locator()
leaf_ct <- leaf_uc[which(leaf_uc$CO2_r > 10 &
leaf_uc$CO2_r < 464), ]
plot(leaf_uc$CO2_r, leaf_uc$A)
# 拟合 ----------------------------------------------------------------------
racir <- fitaci(
leaf_ct,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
),
Patm = 84.09
)
library(plantecophys)
# 拟合 ----------------------------------------------------------------------
racir <- fitaci(
leaf_ct,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
),
Patm = 84.09
)
# 查看拟合数据
racir$pars
# 对快速曲线作图拟合结果进行查看
plot(racir, linecols = c("green", "blue", "red"))
aci <- xls_read(file.choose())
slow <- fitaci(
aci,
varnames =
list(
ALEAF = "A",
Tleaf = "Tleaf",
Ci = "Ci",
PPFD  = "Qin",
Rd = "Rd"
),
Patm = 84.09
)
slow$pars
library(devtools)
check()
document()
install()
library(devtools)
install()
document()
install()
document()
install()
document()
install()
document()
install()
document()
install()
document()
check()
check()
document()
install()
install()
<=
install()
install()
install()
library(devtools)
check()
document()
install()
library(devtools)
check()
document()
check()
install()
install()
library(devtools)
install()
load_all()
leaf <- xls_read(file.choose())
check_delta(leaf, delta_max = 0.8)
leaf$CO2_r
check_delta(leaf, delta_max = 0.8)
check_delta(leaf, delta_max = 0.8)
document()
check()
install()
